<div class="blog">
    <h3>结构型模式(Structural Pattern)之享元模式(Flyweight Pattern)</h3>
    <pre>
    享元可以理解为共享技术，对于经常使用的资源采用共享，可以减少实例的创建，从而减少系统的开销。
    定义:运用共享技术有效地支持大量细粒度对象的复用。系统只使用少量的对象，而这些对象都很相似，
        状态变化很小，可以实现对象的多次复用。由于享元模式要求能够共享的对象必须是细粒度对象，
        因此它又称为轻量级模式，它是一种对象结构型模式。
    </pre>
    <img src="http://img.my.csdn.net/uploads/201206/15/1339770628_5970.jpg">
    <pre>
    典型的享元工厂代码:
    class FlyweightFactory {
        //定义一个HashMap用于存储享元对象，实现享元池
        private HashMap flyweights = newHashMap();

        public Flyweight getFlyweight(String key){
            //如果对象存在，则直接从享元池获取
            if(flyweights.containsKey(key)){
                return(Flyweight)flyweights.get(key);
            }
            //如果对象不存在，先创建一个新的对象添加到享元池中，然后返回
            else {
                Flyweight fw = newConcreteFlyweight();
                flyweights.put(key,fw);
                return fw;
            }
        }
    }
    享元类的设计是享元模式的要点之一，在享元类中要将内部状态和外部状态分开处理，通常将内部状态作为享元类的成员变量，
    而外部状态通过注入的方式添加到享元类中。典型的享元类代码如下所示：
    class Flyweight {
         //内部状态intrinsicState作为成员变量，同一个享元对象其内部状态是一致的
         private String intrinsicState;

         public  Flyweight(String intrinsicState) {
              this.intrinsicState=intrinsicState;
         }

         //外部状态extrinsicState在使用时由外部设置，不保存在享元对象中，即使是同一个对象，在每一次调用时也可以传入不同的外部状态
         public void operation(String  extrinsicState) {
                  ......
         }
    }
    </pre>
    <h5>总结:</h5>
    <pre>
    优点
       享元模式的主要优点如下：
       (1) 可以极大减少内存中对象的数量，使得相同或相似对象在内存中只保存一份，从而可以节约系统资源，提高系统性能。
       (2) 享元模式的外部状态相对独立，而且不会影响其内部状态，从而使得享元对象可以在不同的环境中被共享。

    缺点
       享元模式的主要缺点如下：
       (1) 享元模式使得系统变得复杂，需要分离出内部状态和外部状态，这使得程序的逻辑复杂化。
       (2) 为了使对象可以共享，享元模式需要将享元对象的部分状态外部化，而读取外部状态将使得运行时间变长。

    适用场景
       在以下情况下可以考虑使用享元模式：
       (1) 一个系统有大量相同或者相似的对象，造成内存的大量耗费。
       (2) 对象的大部分状态都可以外部化，可以将这些外部状态传入对象中。
       (3) 在使用享元模式时需要维护一个存储享元对象的享元池，而这需要耗费一定的系统资源，因此，
            应当在需要多次重复使用享元对象时才值得使用享元模式。
    </pre>
</div>
 <div id="disqus_thread"></div>
<script>
    /**
     * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
     */
    var disqus_config = function () {
        this.page.url = 'http://michaelygzhang.github.io/home/'; // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = 'proxy'; //注意这里要修改 Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = '//michaelzhangblog.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
</div>
